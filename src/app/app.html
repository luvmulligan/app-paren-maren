<div class="app">
  <div class="navbar"></div>
  <h1>{{ title() }}</h1>

    <div class="status" *ngIf="gameCreated">
    <div class="room-id center-content"><p>Room ID: <strong> {{ roomId }}</strong></p>
    </div>
        <button (click)="copyRoomId()" matButton="elevated">Copy<mat-icon>file_copy</mat-icon></button>
  <!-- <section class="join" *ngIf="joined">
    <div>Game hosted by {{hostPlayer}}</div>
  </section> -->
 </div>

  <section class="lobby" *ngIf="!gameCreated">
    <div class="player-join" *ngIf="!gameCreated">
      <p>Welcome to Paren Maren Dice Game</p>
      <p>Please write your player name:</p>
    <!-- <mat-form-field class="example-full-width">
    <mat-label>Join as</mat-label>
    <input matInput placeholder="Name" [(ngModel)]="newPlayer">
    </mat-form-field>     -->

     <mat-form-field appearance="outline">
    <mat-label>Join as</mat-label>
    <input matInput placeholder="Name" [(ngModel)]="newPlayer">
  </mat-form-field>
    <!-- <label for="name">Join as </label> -->
    <!-- <input id="name" type="text" [(ngModel)]="newPlayer" placeholder="Name" /> -->
    <!-- <button (click)="joinRoom()" [disabled]="joined || !newPlayer.trim()">Unirse</button> -->
    </div>

  <div class="lobby-actions">

  <section *ngIf="!joinExistingRoomPressed"  class="game-creation">
    <button matButton="outlined" class="new-room-button" (click)="gameCreated = true; createNewRoom()" [disabled]="newPlayer === ''">Create room</button>
  </section>

  <section *ngIf="!gameCreated">
    <button matButton="outlined" *ngIf="!joinExistingRoomPressed" (click)="joinExistingRoomPressed = true;" class="join-room-button" [disabled]="newPlayer === ''">Join room</button>
    <div class="roomId input action" *ngIf="joinExistingRoomPressed">
  <mat-form-field appearance="outline">
    <mat-label>Room ID:</mat-label>
    <input matInput placeholder="Room ID" [(ngModel)]="joinerId" >
  </mat-form-field>
    <!-- <input type="text" [(ngModel)]="joinerId" placeholder="Room ID"/>  -->

    </div>

    <div class="back" *ngIf="joinExistingRoomPressed">
      <button  matButton="outlined" class="join-room-button"(click)="joinRoom(); gameCreated = true">Join</button>
            <button  matButton="outlined"class="go-back-button" (click)="joinExistingRoomPressed = false;"> <mat-icon>arrow_left_alt</mat-icon>Back</button>

    </div>
  </section>
  </div>
</section>
  <!-- <div class="status" *ngIf="gameCreated">
    <div>Room ID: <strong>{{ roomId }}</strong>
    </div>
 
  <section class="join" *ngIf="joined">
    <div>Game hosted by {{hostPlayer}}</div>
  </section>
 </div> -->
  <!-- <section class="lobby">
    <input type="text" placeholder="Nombre" [(ngModel)]="newPlayer" />
    <button type="button" (click)="joinRoom()" [disabled]="!newPlayer">Unirse a la sala</button>    
  </section> -->

    <section class="player-list" *ngIf="joined">
      <!-- <h3>Players</h3> -->
      <div *ngFor="let player of players" class="player-row" [class.current]="currentPlayer() === player.name">
   
        <div class="player-name"> <p>
          {{player.name}} <span *ngIf="hostPlayer === player.name">(Host)</span></p>
          <!-- <span *ngIf="currentPlayer() === player.name" class="badge">En turno</span> -->
        </div>
        <div class="player-score"><mat-chip>{{player.score}}</mat-chip>        <mat-progress-bar mode="determinate" [value]="(player.score*100)/365"></mat-progress-bar></div>  

      </div>
    </section>



  <section class="dice-list">
    <div class="table-container">
    <ng-container *ngIf="dice().length; else noDice" class="min-height">
      <div class="table">
      <div class="dice-container">
      <div *ngFor="let d of dice(); let i = index">
        <img [src]="'assets/dice' + d + '.png'" [alt]="" />
      </div>
      </div>
      <div class="multiplier-container" *ngIf="parenMarenPressed()">
      <img [src]="blackDiceUrl" [alt]="" />
      </div>
      </div>
       </ng-container>
       </div>
    <section class="actions center-content" *ngIf="phase === 'playing'">
    <button type="button" matFab (click)="rollDice()" [disabled]="!canRoll" class="roll-button">Roll!</button>

    <!-- <button type="button" (click)="leaveRoom()">Salir de la sala</button> -->
  </section>
      <div class="center-content">
        <button type="button" matFab *ngIf="canParenMaren()" (click)="rollParenMaren()" [disabled]="!canRoll" class="paren-maren-button">Paren Maren</button>
      </div>
    
   

    <ng-template #noDice>
      <!-- <em>Sin tiradas</em> -->
    </ng-template>
  </section>
  <div class="start-game center-content">
    <button matButton="filled" class="start-game" (click)="startGame()" *ngIf="joined && currentPlayer() === hostPlayer && phase === 'lobby'" [disabled]="currentPlayer() !== hostPlayer">Start Game</button>
</div>
  <button *ngIf="phase === 'playing' || phase === 'ended'" (click)="exitRoom()" class="exit-button" matButton="elevated" color="warn">Exit<mat-icon class="flip-horizontal">exit_to_app</mat-icon></button>

  <app-chat *ngIf="gameCreated"></app-chat>

</div>
